"0","##convert to a Date object"
"0","polls08$middate <-  as.Date(polls08$middate)"
"0","## compute the number of days to Election Day"
"0","polls08$DaysToElection <- as.Date(""2008-11-04"") - polls08$middate"
"0","poll.pred <- rep(NA, 51)"
"0","## extract unique state names which the loop will "
"0","## iterate through"
"0","st.names <- unique(polls08$state)"
"0","## add state names as labels for easy interpretation "
"0","## later on"
"0","names(poll.pred) <- as.character(st.names)"
"0","## loop across 50 states olus DC"
"0","for(i in 1:51){"
"0","  ## subset the ith state"
"0","  state.data <- subset(polls08, "
"0","                       subset = (state == st.names[i]))"
"0","  ## further subset the latest polls within the state"
"0","  latest <- subset(state.data, "
"0","              DaysToElection == min(DaysToElection))"
"0","  ## compute the mean of latest polls and store it"
"0","  poll.pred[i] <- mean(latest$margin)"
"0","}"
